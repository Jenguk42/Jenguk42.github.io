---
title: "Node.js"

categories: 
- Web Development

tags:
- Node.js
  
toc: true
toc_sticky: true
---

> âœ’ Reference: [Node.js tutorial from W3 schools](https://www.w3schools.com/nodejs/nodejs_intro.asp)

## What is Node.js?

Node.js is an open source server environment that runs on various platforms, and uses JavaScript on the server. Node.js runs **single-threaded, non-blocking, asynchronous** programming, which is memory efficient. Node

### What can Node.js do?

- Generate dynamic page content
- Create, open, write, delete, and close files on the server
- Collect form data
- Add, delete, and modify data in your DB

### What is a Node.js file?

Node.js files have extension ".js", and contain tasks that will be executed on certain events. A typical event would be someone trying to access a port on the server.

### How do you use Node.js?

1. Download Node.js from the official website: <https://nodejs.org>
2. Create a Node.js file
3. Initiate the file in the command line interface of your computer:
   - Navigate to the folder where you saved the Node.js file
   - Initiate the file: i.e. `node myfile.js`
4. Now the computer works as a server. If anyone tries to access your computer on the specific port, they get to see your page.

## Modules

Modules are equivalent to JavaScript libraries: they are sets of functions you want to include in your application. Node.js has a set of built-in modules you can use without installation. (See the list of Built-in Modules [here](https://www.w3schools.com/nodejs/ref_modules.asp))

### Creating your own module

The properties and methods saved in the function below are now available outside the module file. It can be saved as `myfirstmodule.js`.

```jsx
export function myDateTime () {
  return Date();
}
```

Using the module in any Node.js file:

```jsx
import { createServer } from 'http';
import { myDateTime } from './myfirstmodule.js';

http.createServer(function (req, res) {
  res.writeHead(200, {'Content-Type': 'text/html'});
  res.write("The date and time are currently: " + dt.myDateTime());
  res.end();
}).listen(8080);
```

## The ES Module

For versions 13.2 and higher, Node.js has stable support of the ECMAScript modules (ES modules in short) which include statements such as `import` and `export`.

You can either:

- Set the module's file extension as `.mjs` or
- Add `package.json` in the nearest parent folder and include `{ "type" : "module" }`

```jsx
// inside package.json:
{
  "type" : "module",
  // ...
}
```

The default format of modules in Node.js is the `CommonJS`. By modifying the `"type"` field as `"module"` in `package.json`, you are explicitly enabling the ES modules to execute all `.js` files in the same directory as ECMAScript modules.

## The HTTP module

The HTTP module can create an HTTP server that listens to server ports and gives a response back to the client.

A function passed into the `http.createServer` method will be executed when someone tries to access the computer on the port specified via `.listen()`.

```jsx
// Include the HTTP module
import { createServer } from 'http';

createServer(function (req, res) {
  res.writeHead(200, {'Content-Type': 'text/html'});
  res.write('Hello World!'); 
  res.end(); 
}).listen(8080); 
```

- `.createServer(function (req, res) => {...}).listen(8080)`
  - Create a server object, and listen on port 8080
  - `req` argument: The requset from the client as an object
  - `res` argument: The response to the server as an object <br><br>
- `.writeHead(200, {'Content-Type': 'text/html'})`
  - If the response from the HTTP server is displayed as HTML, an HTTP header with the correct content type should be included.
  - First argument: Status code (200: all is ok)
  - Second argument: An object containing the response headers <br><br>
- `.write('Hello World!')` Write a response to the client
- `.end()` End the response

### Reading the query string

The `req` argument passed into the `.createServer()` method represents the request from the client as an object (http.IncomingMessage object). This object has a property called "url" which holds the part of the url that comes after the domain name.

```jsx
// Read the url of req:
import { createServer } from 'http';

createServer(function (req, res) {
  res.writeHead(200, {'Content-Type': 'text/html'});
  res.write(req.url);
  res.end();
}).listen(8080);
```

After saving the code above and initiating the file, the address `http://localhost:8080/summer` will provide the result `/summer`.

## The URL module

`.parse()` method of the URL module allows splitting the query string into readable parts.

```jsx
// Split the query string into readable parts:
var http = require('http');
var url = require('url');

http.createServer(function (req, res) {
  res.writeHead(200, {'Content-Type': 'text/html'});
  var q = url.parse(req.url, true).query;
  var txt = q.year + " " + q.month;
  res.end(txt);
}).listen(8080);
```

After saving the code above and initiating the file, the address `http://localhost:8080/?year=2017&month=July` will provide the result `2017 July`.

## The File System module: Node.js as a File Server

The File System module allows you to work with the file system on your computer. Common use for the module:

- Read files: Read the HTML file and return the content
- Create files: Create a file if the specified file does not exist
- Update files
- Delete files
- Rename files

### Read files

```jsx
// An HTML file in the same folder as Node.js:
<html>
  <body>
    <h1>My Header</h1>
    <p>My paragraph.</p>
  </body>
</html>

// A Node.js file that reads the HTML file and return the content:
import { createServer } from 'http';
import { readFile } from 'fs';

createServer(function (req, res) {
  readFile('demofile1.html', function(err, data) {
    res.writeHead(200, {'Content-Type': 'text/html'});
    res.write(data);
    return res.end();
  });
}).listen(8080);
```

After saving the code above and initiating the file, you will see the file rendered at `http://localhost:8080`.

### Create files

The File System module has methods for creating new files:

- `appendFile()` appends specified content to a file. <br>
  If the file does not exist, the file is created.
  
  ```jsx
  import { appendFile } from 'fs';

  appendFile('mynewfile1.txt', 'Hello content!', function (err) {
      if (err) throw err;
      console.log('Saved!');
  });
  ```

- `open()` takes a "flag" as the second argument. If the flag is "w" for "writing", the specified file is open for writing. <br>
  If the file does not exist, an empty file is created.

  ```jsx
  import { open } from 'fs';

  open('mynewfile2.txt', 'w', function (err, file) {
    if (err) throw err;
    console.log('Saved!');
  });
  ```

- `writeFile()` replaces the specified file and content if it exists. <br>
  If the file does not exist, a new file containing the specified content is created.

  ```jsx
